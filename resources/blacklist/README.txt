Author: Anshul Kundaje (Stanford University)
Contributors: Anna Shcherbina (Stanford University)
Contact: akundaje@stanford.edu
Date: 05/05/2020

This the README for the ENCODE Unified GRCh38 Blacklist

The blacklist is a unification of three separate blacklists followed by extensive manual curation

The three blacklists that were unified are as follows

1. The autogenerated blacklist from https://github.com/Boyle-Lab/Blacklist/blob/master/lists/hg38-blacklist.v2.bed.gz . 
The corresponding citation is
Amemiya, H.M., Kundaje, A. & Boyle, A.P. The ENCODE Blacklist: Identification of Problematic Regions of the Genome. Sci Rep 9, 9354 (2019). https://doi.org/10.1038/s41598-019-45839-z   

2. The autogenerated peakPass blacklist from https://github.com/ewimberley/peakPass/blob/master/blacklists/hg38/peakPass60Perc_sorted.bed
The corresponding citation is
Charles E. Wimberley and Steffen Heber.Journal of Computational Biology.Feb 2020.259-268.http://doi.org/10.1089/cmb.2019.0295

3. The blacklist capturing peaks in the nuclear genome that originate from reads from mitochondrial genome taken from https://github.com/caleblareau/mitoblacklist/blob/master/peaks/hg38_peaks.narrowPeak . This blacklist was generated by Caleb Lareau.

Manual curation:
The unified blacklist is NOT just a concatenation  of the above three blacklists. It was extensively manually curated. 
900 DNase-seq tracks from diverse biosamples from the ENCODE project were processed in 3 different ways
1. View1:  Genome-wide base-resolution signal tracks representing -log10(pvalue) statistical significant of enrichment were obtained from MACS2 using unique mapping reads + multimapping reads mapping to upto 4 locations. Duplicates were removed. These tracks were obtained using the following pipeline https://github.com/ENCODE-DCC/atac-seq-pipeline/releases/tag/v1.7.1
2. View2: Genome-wide base-resolution signal tracks representing 5' end read coverage using unique mapping reads with duplicates. These tracks were obtained by appropriately filtering the BAM files from the following pipeline https://github.com/ENCODE-DCC/atac-seq-pipeline/releases/tag/v1.7.1
3. View3: Genome-wide base-resolution signal tracks representing 5' end read coverage using all mappable reads (unique mapping + multimapping) with duplicates. These tracks were obtained by appropriately filtering the BAM files from the following pipeline https://github.com/ENCODE-DCC/atac-seq-pipeline/releases/tag/v1.7.1

The repeat masker track was also used for curation.

Each putative blacklist regions was visualized in the IGV browser using all 3 sets of tracks and manually checked for artifacts. The artifacts are broadly as follows
1. The region showed abnormally high signal (definition of abnormal was subjective) or abnormal shapes of read coverage in most (>90%) biosamples in (View1 or View2) AND view 3
2. The region overlapped pathological repeats like certain classes of Satellite repeats and centromere repeats
3. Regions overlapping annotated TSSs, TESs or splice sites were excluded from the blacklist as far as possible unless the artifact signal was very clear
4. Low mappability/unmappable regions were not explicitly included since these end up having no reads mapping to them. The blacklist is thus complementary to a low mappability track.

How to interpret the blacklist:
We recommend ignoring peaks or signal profiles in these blacklist regions when using standard processing pipelines. It is of course possible that there is interesting biology in these blacklist regions. But analyses in these regions require careful consideration.
